# TFM_Multiview_3D_Reconstruction

## Table Of Contents

* [Overview](#overview)
* [Structure](#structure)
* [Dataset](#dataset)
* [Requirements](#requirements)
* [Parameters](#parameters)
* [Usage](#usage)
* [Results](#results)
* [Author](#author)
* [Acknowledgements](#acknowledgements)

## üîç Overview

This repository presents the first part of my **Computer Vision Master's thesis project**: a pipeline to annotate the [CMU Panoptic Studio dataset](https://www.cs.cmu.edu/~hanbyulj/panoptic-studio/) with accurate 3D facial reconstructions from multiview images. Using [DAD-3DNet](https://github.com/PinataFarms/DAD-3DHeads) for 3D landmark detection, Bundle Adjustment Structure (BAS) via [CvSBA](https://github.com/willdzeng/cvsba) for 3D refinement and a customed **RANSAC** method for view selection. The approach achieves low reprojection error and generates a refined 3D facial dataset aligned with the original images.

The reconstructions With the execution of this code you will get refined 3D annotations that could be used

For a complete overview of the project, check out the complete report in [TFM_Esther_Vera_Moreno](https://github.com/EstherRobotics/TFM_Multiview_3D_Reconstruction/blob/main/TFM_Esther_Vera_Moreno.pdf). 


 ## üóÇÔ∏è Structure


- **src/**
  - **panoptic_reconstruction/**
    - **config/**
      - `config.yaml`: defines paths, sequences, and global parameters.
      - `manage_paths.py`: class for managing and resolving project paths.
    - **csvsba-1.0.0/**: adapted CvSBA implementation for Bundle Adjustment.
    - **DAD_3DHeads_model/**: code and utilities to extract 3D facial landmarks using DAD-3DNet.
    - **data/**
      - **annotations/**
        - `3D_annotations/`: refined 3D landmark predictions.
        - `nsreprojections/`: 2D landmarks on cropped face images.
        - `reprojections/`: 2D landmarks projected onto full-size images.
      - **cameras_info/**: files used for Bundle Adjustment (`fy.txt`, `mycams.txt`, `mypoints.txt`, `newpoints.txt`).
      - **cropped_imgs_for_evaluation/**: face crops for each sequence (visual check).
      - **files/**
        - `panoptic_ann_train.txt`, `panoptic_ann_valid.txt`, `panoptic_ann_test.txt`: sequence/image lists for batch processing.
    - **face_processor/**
      - `face_cropper.py`, `face_detection.py`, `face_occlusion.py`, `face_pose.py`: modules for detecting, cropping, filtering, and estimating face pose.
    - **panoptic_cameras/**
      - `manage_cameras.py`: loads and handles Panoptic Studio camera parameters.
    - **panoptic_points/**
      - `panoptic_body_points.py`, `panoptic_landmarks.py`: load body/face annotations from Panoptic for evaluation and filtering.
    - **prediction/**
      - `landmarks_selector_3D.py`, `scaled_landmarks_processor.py`: predict, select and scale 3D landmarks.
    - **reconstruction/**
      - `bundle_adjustment.py`: refines 3D points using Bundle Adjustment Structure.
      - `linear_reconstruction.py`: initial 3D triangulation using two views.
      - `projection_utils.py`: projects 3D landmarks onto 2D image planes.
      - `ransac.py`: selects best camera views using a custom RANSAC method.
      - `reconstruction_processor.py`: full pipeline logic for reconstruction and refinement.
    - **utils/**: helper functions for file I/O, data storage, sequence tracking, and image references.
    - `from_txt.py`: batch reconstruction script using lists from `data/files/`.
    - `main.py`: main execution script; runs reconstruction using predefined sequences.

- **panoptic_reconstruction.egg-info/**: package metadata (autogenerated).
- **pyproject.toml**: project metadata and dependency configuration.
- **requirements.txt**: required Python libraries.
- **README.md**: project overview and usage instructions.
- **TFM_Esther_Vera_Moreno/**: final Master's thesis report.



## üìÑ Dataset 



## üíª Requirements



## ‚öôÔ∏è Parameters

The parameters are defined...



## üöÄ Usage




## üìä Results




## Authors

* **Esther Vera** -
* [Personal Github](https://github.com/EstherNoumena)
* [ICAERUS Github](https://github.com/ICAERUS-EU/UC1_Crop_Monitoring)
* [LinkedIn](https://www.linkedin.com/in/estherverarobotics/) 

## Acknowledgements
* **Jos√© Miguel Buenaposada** - [Jos√© Miguel B.](https://github.com/jmbuena/) - Master Thesis Tutor
